---
# Sway role - XKB keyboard configuration
# Deploys custom XKB keymap that maps Right Control to Mod3

- name: Sway | Ensure XKB keymap directory exists
  ansible.builtin.file:
    path: "{{ sway_config_dest }}/xkb/keymap"
    state: directory
    mode: "0755"
    owner: "{{ sway_username }}"
    group: "{{ sway_username }}"
  become: true
  when: sway_deploy_custom_xkb_keymap | bool

- name: Sway | Deploy custom XKB keymap file
  ansible.builtin.template:
    src: xkb-keymap-custom.j2
    dest: "{{ sway_config_dest }}/{{ sway_xkb_keymap_path }}"
    mode: "0644"
    owner: "{{ sway_username }}"
    group: "{{ sway_username }}"
  become: true
  when: sway_deploy_custom_xkb_keymap | bool

- name: Sway | Ensure XKB symlink exists in .config
  ansible.builtin.file:
    src: "{{ sway_config_dest }}/xkb"
    dest: "/home/{{ sway_username }}/.config/xkb"
    state: link
    owner: "{{ sway_username }}"
    group: "{{ sway_username }}"
    force: true
  become: true
  when: sway_deploy_custom_xkb_keymap | bool
